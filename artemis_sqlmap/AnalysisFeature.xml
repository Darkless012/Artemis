<?xml version="1.0" encoding="UTF-8" ?> 
 
<!DOCTYPE sqlMap 
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd"> 
 

<sqlMap namespace="AnalysisFeature"> 

  <typeAlias alias="AnalysisFeature"
        type="org.gmod.schema.analysis.AnalysisFeature"/>
   
    <resultMap id="select-analysisfeature" 
                class="AnalysisFeature">
        <result property="rawScore" column="rawscore" />
        <result property="normScore" column="normscore" />
        <result property="significance" column="significance" />
        <result property="analysis" column="analysis_id" select="selectAnalysis" />
     </resultMap>  
        
    <select id="selectAnalysisFeatures" resultMap="select-analysisfeature">
       SELECT rawscore, normscore, significance, analysis_id
       FROM analysisfeature
       WHERE feature_id=#feature_id#
    </select>
     
     
    <!--  INSERT  -->
    <insert id="insertAnalysisFeature" 
            parameterClass="AnalysisFeature">
      INSERT INTO analysisfeature 
        ( feature_id, analysis_id
        <isNotNull property="rawScore">     ,rawscore </isNotNull>
        <isNotNull property="normScore">    ,normscore </isNotNull>
        <isNotNull property="significance"> ,significance </isNotNull>
        <isNotNull property="identity">     ,identity </isNotNull>)
      VALUES
        ( $feature.featureId$,
          (SELECT analysis_id FROM analysis WHERE program=#analysis.program#)
          <isNotNull property="rawScore">     ,$rawScore$ </isNotNull>
          <isNotNull property="normScore">    ,$normScore$ </isNotNull>
          <isNotNull property="significance"> ,$significance$ </isNotNull>
          <isNotNull property="identity">     ,$identity$ </isNotNull> )
    </insert>

</sqlMap>