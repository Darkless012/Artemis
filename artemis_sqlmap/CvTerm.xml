<?xml version="1.0" encoding="UTF-8" ?> 
 
<!DOCTYPE sqlMap 
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd"> 
 

<sqlMap namespace="CvTerm"> 

    <typeAlias alias="CvTerm"
        type="uk.ac.sanger.artemis.chado.CvTerm"/>
 
    <resultMap id="select-cvterm-names-result" class="CvTerm">
   	  <result property="cvTermId" column="cvterm_id"/>
  	  <result property="name" column="cvterm_name"/>
      <result property="cv.name" column="cv_name"/>
    </resultMap>
    
    <resultMap id="lazy-cvterm" class="CvTerm">
   	  <result property="cvTermId" column="cvterm_id"/>
  	  <result property="name" column="name"/>
      <result property="definition" column="definition"/>
      <result property="dbXRef" column="dbxref_id" select="selectDbXRef"/>
      <result property="isObsolete" column="is_obsolete"/>
      <result property="isRelationshiptype" column="is_relationshiptype"/>
    </resultMap>
    

    <!-- look up cvterms names and id -->
     <select id="getCvterm" resultMap="select-cvterm-names-result"> 
   	SELECT  
	  cvterm.CVTERM_ID, cvterm.NAME as cvterm_name, cv.NAME as cv_name
        FROM cvterm, cv
        WHERE 
            <dynamic>
             <isNotNull property="name">
               cvterm.name=#name# AND
             </isNotNull>
             <isNotNull property="cv_name">
               cv.name=#cv_name# AND
             </isNotNull>
             <isNotNull property="cvterm_id">
               cvterm_id=#cvterm_id# AND
             </isNotNull>
            </dynamic>
	    cv.cv_id = cvterm.cv_id
     </select> 
     
      <!-- look up cvterms names and id -->
     <select id="selectCvterm" 
             resultMap="lazy-cvterm"> 
       SELECT *
       FROM cvterm
       WHERE cvterm_id=#value# 
     </select> 
</sqlMap> 
