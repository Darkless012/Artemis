<!DOCTYPE sqlMap 
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd"> 
 

<sqlMap namespace="FeatureCvTermDbXRef"> 

     <typeAlias alias="FeatureCvTermDbXRef"
        type="org.gmod.schema.sequence.FeatureCvTermDbXRef"/>
        
     <resultMap id="select-featurecvtermdbxref" class="FeatureCvTermDbXRef"
                groupBy="featureCvTermId">
        <result property="featureCvTerm.featureCvTermId"   column="feature_cvterm_id" />
        <result property="dbXRef.accession"   column="accession"/>
        <result property="dbXRef.version"     column="version"/>
        <result property="dbXRef.description" column="description"/>
        <result property="dbXRef.db.name" column="name"/>
    </resultMap>
   
    <select id="getFeatureCvTermDbXRef" parameterClass="Feature"
             resultMap="select-featurecvtermdbxref">
       SELECT fcd.feature_cvterm_id, dbx.*, db.name 
       FROM feature_cvterm_dbxref fcd 
       LEFT JOIN dbxref dbx ON dbx.dbxref_id=fcd.dbxref_id 
       LEFT JOIN db ON db.db_id=dbx.db_id
       <dynamic>
          <isNotNull property="uniqueName">
            LEFT JOIN feature_cvterm fc ON fcd.feature_cvterm_id=fc.feature_cvterm_id
            WHERE
            feature_id=(SELECT feature_id FROM feature WHERE uniquename=#uniqueName#)
          </isNotNull>
       </dynamic>
    </select>
     
</sqlMap>