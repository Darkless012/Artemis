<?xml version="1.0" encoding="UTF-8" ?> 
 
<!DOCTYPE sqlMap 
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd"> 
 

<sqlMap namespace="Dbxref"> 
 
  <select id="getDbxref" parameterClass="uk.ac.sanger.artemis.chado.ChadoFeature"
                             resultClass="uk.ac.sanger.artemis.chado.Dbxref">
   	SELECT  
	  db.name,
	  dbx.accession,
          f.feature_id
 	FROM $schema$.feature_dbxref dbx_f 
        LEFT JOIN dbxref dbx ON dbx.dbxref_id=dbx_f.dbxref_id
        LEFT JOIN db ON db.db_id=dbx.db_id 
        LEFT JOIN $schema$.feature f ON dbx_f.feature_id=f.feature_id
        <isNotNull property="uniquename"> 
          WHERE f.uniquename=#uniquename#
        </isNotNull>
        <isGreaterThan property="id" compareValue="0">
          WHERE dbx_f.feature_id=$id$
        </isGreaterThan>
        ORDER BY f.type_id,  uniquename
  </select> 

</sqlMap> 
